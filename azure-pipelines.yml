trigger:
- main  # Or your default branch

pool:
  name: 'Default'  # Make sure this matches your agent pool

steps:
- task: DotNetCoreCLI@2
  inputs:
    command: 'restore'
    projects: 'Software-Quality-and-Testing-project/SoftwareQuality.sln'
  displayName: 'Restore dependencies'

- task: DotNetCoreCLI@2
  inputs:
    command: 'build'
    projects: 'Software-Quality-and-Testing-project/SoftwareQuality.sln'
  displayName: 'Build project'

- task: DotNetCoreCLI@2
  inputs:
    command: 'test'
    projects: 'Software-Quality-and-Testing-project/InsuranceServiceTests/InsuranceServiceTests.csproj'
    arguments: '--configuration Release --logger "trx"'
  displayName: 'Run tests'

- task: PublishTestResults@2
  inputs:
    testResultsFormat: 'NUnit'
    testResultsFiles: '**/TestResults/**/*.xml'
    failTaskOnFailedTests: true
  displayName: 'Publish test results'
